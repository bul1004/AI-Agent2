### チームモードでのサブスクリプション (`team-subscription`)

- 組織に所属するオーナー/管理者がチーム単位でサブスクリプションを契約できることを確認

#### テストケース

| テスト名                                               | 確認事項                                                         |
| ------------------------------------------------------ | ---------------------------------------------------------------- |
| `オーナー権限でプラン詳細が正しく表示される`           | 「/シート/月」表記、「チームプランを始める」ボタン、プラン詳細   |
| `管理者権限でプラン詳細が正しく表示される`             | 管理者もオーナーと同様にサブスクリプション管理可能               |
| `オーナー権限でStripeチェックアウトにリダイレクトされる` | 「チームプランを始める」クリックでStripeへリダイレクト           |

#### 手順（オーナー権限でプラン詳細表示確認）

1. シードデータのオーナーユーザー（e2e-owner@example.com）でログイン
2. サイドバーのプロフィールボタンをクリック
3. 「E2E Test Team」を選択してチームモードに切り替え
4. 再度プロフィールボタンをクリック
5. 「プランをアップグレード」メニューをクリック
6. モーダルが開き、以下が表示されることを確認:
   - 「/シート/月」の表記
   - 「チームプランを始める」ボタン（有効状態）
   - プラン料金（¥9,800）
   - 「30日間返金保証」のテキスト

#### 手順（管理者権限でプラン詳細表示確認）

1. シードデータの管理者ユーザー（e2e-admin@example.com）でログイン
2. サイドバーのプロフィールボタンをクリック
3. 「E2E Test Team」を選択してチームモードに切り替え
4. 再度プロフィールボタンをクリック
5. 「プランをアップグレード」メニューをクリック
6. オーナーと同様の表示を確認

#### 手順（Stripeチェックアウトリダイレクト）

1. シードデータのオーナーユーザーでログイン
2. チームモードに切り替え
3. サブスクリプションモーダルを開く
4. 「チームプランを始める」ボタンをクリック
5. `checkout.stripe.com` にリダイレクトされることを確認

#### 前提条件

- シードデータが投入済み（`supabase db reset`）
- Stripe テスト環境が設定済み
- `STRIPE_SECRET_KEY`, `STRIPE_PRICE_ID_BUSINESS` が環境変数に設定済み

#### 使用するシードデータ

| ロール | メール                 | パスワード          | 組織          |
| ------ | ---------------------- | ------------------- | ------------- |
| owner  | e2e-owner@example.com  | E2eTestPassword123! | E2E Test Team |
| admin  | e2e-admin@example.com  | E2eTestPassword123! | E2E Test Team |

#### 使用するページオブジェクト

| クラス        | 用途                                   |
| ------------- | -------------------------------------- |
| `BillingPage` | サブスクリプションモーダルの操作・検証 |

#### 使用するヘルパー関数

| 関数名                 | 用途                                     |
| ---------------------- | ---------------------------------------- |
| `loginAsUser`          | シードデータのユーザーでログイン         |
| `switchToOrganization` | チームモード（E2E Test Team）に切り替え  |

#### 備考

- シードデータのユーザーを使用するため、afterEachでのクリーンアップは不要
- チームモードでは `organizationId` を課金対象IDとして使用
- オーナーと管理者は同等のサブスクリプション管理権限を持つ

