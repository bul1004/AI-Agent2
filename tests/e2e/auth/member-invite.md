### メンバー招待 (`member-invite`)

- 組織オーナーがメンバーを招待し、招待されたユーザーが組織に参加できることを確認

#### テストケース

| テスト名                                                 | 確認事項                                               |
| -------------------------------------------------------- | ------------------------------------------------------ |
| `組織オーナーがメンバーを招待できる`                     | 組織設定から招待を送信し、成功トーストが表示される     |
| `招待IDがない場合はエラーが表示される`                   | `/invite/accept` にIDなしでアクセスするとエラー表示    |
| `未ログイン時は招待受け入れページでログイン促進が表示される` | ログインしていない状態でログイン/新規登録ボタンが表示  |
| `招待を受け入れて組織に参加できる`                       | 招待リンクから組織に参加し、チャットページへリダイレクト |

#### 手順（メンバー招待 - ハッピーパス）

1. テストユーザーを新規作成してログイン状態にする
2. サイドバーのドロップダウンを開く
3. 「チームを作成」ボタンをクリック
4. チーム名を入力して作成
5. 再度サイドバーのドロップダウンを開く
6. 「設定」メニューをクリック
7. モーダル内の「組織」タブをクリック
8. 「招待」ボタンをクリック
9. 招待モーダルでメールアドレスを入力
10. 「招待を送信」ボタンをクリック
11. 成功トースト「招待しました」が表示されることを確認

#### 手順（招待IDなし - エラー表示）

1. `/invite/accept` にIDパラメータなしでアクセス
2. 「招待IDが見つかりません」エラーメッセージが表示されることを確認

#### 手順（未ログイン時のログイン促進）

1. `/invite/accept?id=fake-invitation-id` にアクセス
2. 「ログインが必要です」メッセージが表示されることを確認
3. 「ログイン」ボタンが表示されることを確認
4. 「新規登録」ボタンが表示されることを確認

#### 手順（招待受け入れ - フルフロー）

1. オーナーユーザーを作成してログイン状態にする
2. 組織を作成する
3. メンバーを招待する（上記手順 5-11）
4. DBから招待IDを取得
5. オーナーをサインアウト
6. 招待されたメールアドレスで新規ユーザーを作成
7. `/invite/accept?id={招待ID}` にアクセス
8. 「招待を受け入れました」メッセージが表示されることを確認
9. `/chat` にリダイレクトされることを確認

#### 前提条件

- なし（テストごとに新規ユーザー・組織を作成）
- DBアクセスが必要なテスト（招待受け入れフルフロー）は `SUPABASE_SERVICE_ROLE_KEY` が必要

#### 使用するヘルパー関数

| 関数名                     | 用途                                       |
| -------------------------- | ------------------------------------------ |
| `createTestUser`           | テストユーザーを作成してログイン状態にする |
| `cleanupTestUser`          | テストユーザーをクリーンアップする         |
| `generateTestEmail`        | ユニークなテストメールアドレスを生成       |
| `createOrganization`       | 組織を作成する                             |
| `openOrganizationSettings` | 組織設定タブを開く                         |
| `getInvitationFromDB`      | DBから招待IDを取得する                     |

#### 備考

- 各テスト後に `cleanupTestUser` でテストユーザーをクリーンアップ
- fixtures.ts の共通ヘルパーを使用
- `getInvitationFromDB` はSupabase Admin クライアントを使用してDBから招待情報を取得
- DB接続がない場合、招待受け入れフルフローテストはスキップされる
